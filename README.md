# pinfomap

## Description

Generates Go code from a template by referencing package information such as package names, imports, and struct fields.

## Examples

### Accessors

`./foo.go` contains the struct `Foo`:

```go
package main

import (
	goimports "github.com/incu6us/goimports-reviser/v3/reviser"
	"text/template"
)

type Foo struct {
	bar  string `accessor:"setter,getter=true"`
	Baz  int
	qux  template.Template   `accessor:"getter,setter=false"`
	quux goimports.SourceDir `accessor:"setter"`
}

func (rcv *Foo) Greet() string {
	return "Hello"
}

func (rcv Foo) Greet2() string {
	return "World"
}
```

`./gen_foo_accessors_go/main.go` serves as an accessor generator for the struct:

```go
package main

import (
	"github.com/knaka/pinfomap"
)

func main() {
	structInfo, err := pinfomap.GetStructInfo(".", "Foo", &pinfomap.GetStructInfoParams{
		Tags: []string{"accessor"},
	})
	if err != nil {
		panic(err)
	}
	err = pinfomap.Generate(pinfomap.AccessorsTemplate, structInfo)
	if err != nil {
		panic(err)
	}
}
```

Running `go run ./gen_foo_accessors/` will generate the following code as `./foo_accessors.go`:

```go
// Code generated by gen_foo_accessors; DO NOT EDIT.

package main

import (
	"text/template"

	"github.com/incu6us/goimports-reviser/v3/reviser"
)

func (rcv *Foo) GetBar() string {
	return rcv.bar
}

func (rcv *Foo) SetBar(value string) {
	rcv.bar = value
}

func (rcv *Foo) GetQux() template.Template {
	return rcv.qux
}

func (rcv *Foo) SetQuux(value reviser.SourceDir) {
	rcv.quux = value
}
```

Running `go run ./gen_foo_accessors.go` also works if you prefer to place the generator code in the same directory as `./foo.go`.

While the above example is using the template `AccessorsTemplate`, you can use your own template by passing it to `pinfomap.Generate`. The `AccessorsTemplate` is defined as follows:

```gotemplate
// Code generated by {{.GeneratorName}}; DO NOT EDIT.

package {{$.PackageName}}

import (
{{range $.Imports}}
	"{{.}}"
{{end}}
)

{{range $.PrivateFields}}
{{if eq .Params.getter "true"}}
func (rcv *{{$.StructName}}) Get{{.CapName}}() {{.Type}} {
	return rcv.{{.Name}}
}
{{end}}{{/* if */}}

{{if eq .Params.setter "true"}}
func (rcv *{{$.StructName}}) Set{{.CapName}}(value {{.Type}}) {
	rcv.{{.Name}} = value
}
{{end}}{{/* if */}}
{{end}}{{/* range */}}
```
